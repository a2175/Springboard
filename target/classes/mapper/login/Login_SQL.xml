<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="login">

	<select id="selectUserDetail" parameterType="hashmap" resultType="hashmap">
    	<![CDATA[
        	SELECT
            	ID,
            	PASSWORD,
            	NICKNAME,
            	EMAIL,
            	DATE_FORMAT(CREA_DTM,'%Y-%m-%d %I:%i:%s') AS CREA_DTM
        	FROM
            	tb_user
        	WHERE
            	ID = #{IDX}
    	]]>
	</select>
	
	<select id="selectLoginCheck" parameterType="hashmap" resultType="hashmap">
    	<![CDATA[
        	SELECT
            	ID,
            	PASSWORD,
            	NICKNAME,
            	EMAIL,
            	DATE_FORMAT(CREA_DTM,'%Y-%m-%d %I:%i:%s') AS CREA_DTM
        	FROM
            	tb_user
        	WHERE
            	ID = #{ID}
            	AND PASSWORD = #{PASSWORD}
    	]]>
	</select>
	
	<select id="selectIdCheck" parameterType="hashmap" resultType="hashmap">
    	<![CDATA[
        	SELECT
            	ID,
            	PASSWORD,
            	NICKNAME,
            	EMAIL,
            	DATE_FORMAT(CREA_DTM,'%Y-%m-%d %I:%i:%s') AS CREA_DTM
        	FROM
            	tb_user
        	WHERE
            	ID = #{ID}
    	]]>
	</select>
	
	<select id="selectNicknameCheck" parameterType="hashmap" resultType="hashmap">
    	<![CDATA[
        	SELECT
            	ID,
            	PASSWORD,
            	NICKNAME,
            	EMAIL,
            	DATE_FORMAT(CREA_DTM,'%Y-%m-%d %I:%i:%s') AS CREA_DTM
        	FROM
            	tb_user
        	WHERE
            	NICKNAME = #{NICKNAME}
    	]]>
	</select>
	
	<insert id="insertUser" parameterType="hashmap">
    	<![CDATA[
        	INSERT INTO tb_user
			(
 				ID,
 				PASSWORD,
 				NICKNAME,
 				EMAIL,
 				CREA_DTM
			)
			VALUES
			(
    			#{ID},
    			#{PASSWORD},
    			#{NICKNAME},
    			#{EMAIL},
    			null
			)
    	]]>
	</insert>
	
	<select id="selectUserById" resultType="first.login.vo.CustomUserDetails">
        <![CDATA[
            SELECT
                *
            FROM
                users
            WHERE
                USERNAME=#{username}
        ]]>
	</select>
	
	<select id="selectAuthorityById" resultType="String">
        <![CDATA[
            SELECT
                authority
            FROM
                authorities
            WHERE
                USERNAME=#{username}
        ]]>
	</select>

</mapper>